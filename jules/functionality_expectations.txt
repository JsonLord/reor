### **Functionality Expectations**

| Feature               | Status       | Notes                                  |
|-----------------------|--------------|----------------------------------------|
| **BLABLADOR LLM API**     | ✅ Adopted   | Replaces Ollama/OpenAI logic with OpenAI-compatible endpoint (`alias-large`). |
| **Semantic Search**       | ✅ Retained  | LanceDB embeddings and vector search unchanged. |
| **RAG Q&A**               | ✅ Adopted   | Retrieval-augmented generation using BLABLADOR’s `alias-large` model. |
| **API Forwarding**        | ✅ Implemented | FastAPI/Flask proxy exposes Reor’s internal APIs externally. |
| **Docker Deployment**     | ✅ Implemented | Containerized for Hugging Face Spaces compatibility (port `7860` exposed). |
| **Hugging Face Secrets**  | ✅ Secured   | `BLABLADOR_API_KEY` masked in Space environment variables. |

---

### **API Endpoints (Exposed via Hugging Face Space)**
| Endpoint            | Method | Description                          | Auth Required |
|---------------------|--------|--------------------------------------|---------------|
| `/notes`            | GET    | List all notes in the corpus.        | Optional      |
| `/notes/:id`        | POST   | Create/update a markdown note.       | API Key       |
| `/notes/:id`        | GET    | Retrieve a note by ID.               | Optional      |
| `/search`           | GET    | Semantic search query (embedding-based). | Optional      |
| `/qa`               | POST   | RAG-powered question-answering.       | API Key       |
| `/related`          | GET    | Retrieve related notes via vector similarity. | Optional      |

**Example API Usage (RAG Q&A):**
```bash
curl -X POST "https://harvesthealth-magnetic-ui.hf.space/qa" \
  -H "Authorization: Bearer YOUR_BLABLADOR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{"query": "Summarize my notes on AI ethics"}'
```

---
### **Core AI Features**
1. **Local Knowledge Embedding**
   - Notes chunked and stored as vectors in **LanceDB** (unchanged).
   - Semantic similarity used for note linking.

2. **RAG Pipeline**
   - Query → Retrieve relevant notes → Generate answer via BLABLADOR (`alias-large`).
   - Supports follow-up questions and context-aware responses.

3. **OpenAI-Compatible LLM**
   - BLABLADOR API (`https://api.helmholtz-blablador.fz-juelich.de/v1`) mimics OpenAI’s `/v1/chat/completions` endpoint.
   - Key adaptations:
     - Replace Ollama logic with BLABLADOR API calls.
     - Handle API rate limits/errors gracefully.

4. **Editor Integration**
   - Sidebar reveals related notes (vector-matched) in real-time.
   - Markdown editor with Obsidian-like syntax.

5. **Local-First Security**
   - All data stored locally (no cloud sync by default).
   - API keys secured via Hugging Face Space secrets.

---
### **Deployment-Specific Features**
- **Port Forwarding**: Hugging Face Space routes external traffic (`harvesthealth-magnetic-ui.hf.space`) to Reor’s `7860` port.
- **Environment Variables**:
  - `BLABLADOR_API_KEY` fetched from Space secrets (not hardcoded).
  - Additional vars for LanceDB path, model aliases, etc.
- **Docker Optimization**:
  - Multi-stage build to reduce image size.
  - Health checks for API endpoints.